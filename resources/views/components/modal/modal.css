/* Lock page scroll when any modal is open */
html:has(dialog[open]) {
    overflow: hidden;
}

@layer components {
    .spire-modal {
        @apply fixed p-0 border-0 bg-transparent overflow-visible;
        @apply max-w-none max-h-none;
    }

    .spire-modal::backdrop {
        @apply bg-black/50 backdrop-blur-sm;
        @apply transition-all duration-200;
    }

    .spire-modal--modal {
        @apply inset-0 m-auto w-full;
        opacity: 0;
        transform: scale(0.9);
    }

    .spire-modal--modal[open] {
        opacity: 1;
        transform: scale(1);
        transition: opacity 150ms, transform 150ms;
        transition-timing-function: var(--ease-bounce);
    }

    @starting-style {
        .spire-modal--modal[open] {
            opacity: 0;
            transform: scale(0.9);
        }

        .spire-modal[open]::backdrop {
            @apply bg-black/0 backdrop-blur-none;
        }
    }

    .spire-modal--sm {
        @apply max-w-sm;
    }

    .spire-modal--md {
        @apply max-w-md;
    }

    .spire-modal--lg {
        @apply max-w-lg;
    }

    .spire-modal--xl {
        @apply max-w-xl;
    }

    .spire-modal--2xl {
        @apply max-w-2xl;
    }

    .spire-modal--full {
        @apply max-w-full mx-4;
    }

    .spire-modal--flyout {
        @apply inset-y-0 m-0;
        @apply flex flex-col overflow-hidden;
        @apply bg-surface text-text;
        @apply shadow-2xl;
        @apply min-h-dvh max-h-dvh;
        @apply transition-all duration-200 ease-out;
    }

    .spire-modal--flyout-left {
        @apply left-0 right-auto;
        @apply border-r border-border;
        transform: translateX(-100%);
    }

    .spire-modal--flyout-left[open] {
        transform: translateX(0);
    }

    @starting-style {
        .spire-modal--flyout-left[open] {
            transform: translateX(-100%);
        }
    }

    .spire-modal--flyout-right {
        @apply left-auto right-0;
        @apply border-l border-border;
        transform: translateX(100%);
    }

    .spire-modal--flyout-right[open] {
        transform: translateX(0);
    }

    @starting-style {
        .spire-modal--flyout-right[open] {
            transform: translateX(100%);
        }
    }

    .spire-modal--flyout.spire-modal--sm {
        @apply w-64;
    }

    .spire-modal--flyout.spire-modal--md {
        @apply w-80;
    }

    .spire-modal--flyout.spire-modal--lg {
        @apply w-96;
    }

    .spire-modal--flyout.spire-modal--xl {
        @apply w-[28rem];
    }

    .spire-modal--flyout.spire-modal--2xl {
        @apply w-[32rem];
    }

    .spire-modal--flyout.spire-modal--full {
        @apply w-full;
    }

    .spire-modal__content {
        @apply relative bg-surface text-text;
        @apply border border-border rounded-lg shadow-2xl;
        @apply flex flex-col w-full;
        @apply overflow-hidden;
        @apply max-h-[calc(100dvh-2rem)];
    }

    .spire-modal--flyout-left .spire-modal__content {
        @apply w-80;
    }

    .spire-modal--flyout-right .spire-modal__content {
        @apply w-80;
    }

    .spire-modal--flyout.spire-modal--sm .spire-modal__content {
        @apply w-64;
    }

    .spire-modal--flyout.spire-modal--md .spire-modal__content {
        @apply w-80;
    }

    .spire-modal--flyout.spire-modal--lg .spire-modal__content {
        @apply w-96;
    }

    .spire-modal--flyout.spire-modal--xl .spire-modal__content {
        @apply w-[28rem];
    }

    .spire-modal--flyout.spire-modal--2xl .spire-modal__content {
        @apply w-[32rem];
    }

    .spire-modal--flyout.spire-modal--full .spire-modal__content {
        @apply w-full;
    }

    .spire-modal__header {
        @apply flex items-center justify-between gap-4;
        @apply px-6 py-4 border-b border-border;
        @apply shrink-0;
    }

    .spire-modal__title {
        @apply text-lg font-semibold text-text;
        @apply m-0;
    }

    .spire-modal__body {
        @apply flex-1 overflow-y-auto;
        @apply px-6 py-4;
        overscroll-behavior: contain;
    }

    .spire-modal__body--no-padding {
        @apply p-0;
    }

    .spire-modal__body--sm {
        @apply px-4 py-3;
    }

    .spire-modal__body--lg {
        @apply px-8 py-6;
    }

    .spire-modal__footer {
        @apply flex items-center justify-end gap-3;
        @apply px-6 py-4 border-t border-border;
        @apply shrink-0;
    }

    .spire-modal__close {
        @apply inline-flex items-center justify-center;
        @apply w-8 h-8 rounded-md;
        @apply text-text-muted hover:text-text;
        @apply hover:bg-hover;
        @apply transition-colors;
        @apply border-0 bg-transparent cursor-pointer;
    }

    .spire-modal__close:focus-visible {
        @apply outline-2 outline-offset-2 outline-primary;
    }
}
